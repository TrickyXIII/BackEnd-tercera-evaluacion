{% extends 'base.html' %}
{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Reporte de Pedidos</h2>

    <form class="row g-3 mb-4 p-3 bg-light border rounded" method="GET">
        <div class="col-auto">
            <label>Desde:</label>
            <input type="date" name="fecha_inicio" class="form-control" value="{{ request.GET.fecha_inicio }}">
        </div>
        <div class="col-auto">
            <label>Hasta:</label>
            <input type="date" name="fecha_fin" class="form-control" value="{{ request.GET.fecha_fin }}">
        </div>
        <div class="col-auto align-self-end">
            <button type="submit" class="btn btn-primary">Filtrar</button>
            <a href="{% url 'reporte' %}" class="btn btn-outline-secondary">Limpiar</a>
        </div>
    </form>

    <div class="row">
        <div class="col-md-6">
            <div class="card shadow p-2">
                <canvas id="myChart"></canvas>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header bg-dark text-white">Detalle Num√©rico</div>
                <ul class="list-group list-group-flush">
                    {% for item in data_tabla %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Estado: {{ item.estado|upper }}
                        <span class="badge bg-primary rounded-pill">{{ item.total }}</span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-center text-muted">No hay datos en este rango.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  new Chart(document.getElementById('myChart'), {
    type: 'pie',
    data: {
      labels: {{ labels|safe }},
      datasets: [{ 
        label: 'Cantidad', 
        data: {{ values|safe }},
        borderWidth: 1 
      }]
    }
  });
</script>
{% endblock %}